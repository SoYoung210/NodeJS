## Redux 왜 쓸까.

기본적으로는 보통 하나의 루트 컴포넌트에서 상태를 관리한다. 

![img](https://i.imgur.com/nnYKPBo.png)

`App` 에서는 인풋의 값인 `input` 값과, 이를 변경하는 `onChange` 함수와, 새 아이템을 생성하는 `onCreate` 함수를 `props` 로 Form에게 전달한다. 

Form은 해당 함수와 값을 받아서 보여주고, 이벤트가 일어나면 부모에게 받은 `onChange` 를 호출하여 App이 지닌 `input` 값을 업데이트 한다. 



부모 컴포넌트가 모든걸 관리하는 구조는, 직관적이긴 하지만 규모가 커지면 코드도 길어지고 유지보수도 힘들어진다. 

### 상태관리를 컴포넌트 바깥에서 한다. 

![img](https://i.imgur.com/c6A4cHg.png)



이렇게 스토어 개념이 생긴다. 

![img](https://i.imgur.com/uROrrOc.png)



`G Component` 는 스토어에 구독을 하고,나중에 스토어의 상태값에 변경이 생기면 전달 받았던 함수를 호출한다. 

![img](https://i.imgur.com/1e4ltmz.png)



이러한 과정이 리덕스 스토어에서 값을 업데이트 하는 과정이다. 



### 리듀서를 통한 상태변화

`action` 객체를 받으면, 전달 받은 액션의 타입에 따라 어떻게 상태를 업데이트 해야 할지 정의 해줘야 한다. 이러한 업데이트 로직을 정의하는 함수를 `reducer` 라고 한다. 

![img](https://i.imgur.com/vasxqlQ.png)



리듀서 함수는 두 가지 인자를 받는다.

1. **state** : 현재 상태
2. **action ** : 액션 객체 

그리고, 이 두가지 파라미터를 참조하여 새로운 상태 객체를 만들어서 이를 반환한다. 

상태에 변화가 생기면, 이전에 컴포넌트가 스토어에게 구독할 때 전달했던 함수 listener 가 호출된다. 

이를 통하여 컴포넌트는 새로운 상태를 받게되고, 이에 따라 리렌더링이 이루어 진다. 



### 리덕스의 3가지 규칙

리덕스를 프로젝트에 사용할 때 3가지 규칙이 있다. 

#### 1. 하나의 애플리케이션 안에는 하나의 스토어가 있다.

하나의 App안에선 단 한개의 스토어를 만들어 사용한다. 

#### 2. 상태는 읽기 전용이다.

기존의 상태는건들이지 않고, 새로운 상태를 생성하여 업데이트 해주어야 한다. 

리덕스에서 불병성을 유지해야 하는 이유는, 내부적으로 데이터가 변경되는 것을 감지하기 위하여 

`shallow equality` 검사를 하기 때문이다. 

#### 3. 변화를 일으키는 함수, 리듀서는 순수한 함수여야 한다. 

- 리듀서 함수는 이전 상태와, 액션 객체를 파라미터로 받는다. 
- 이전의 상태는 절대로 건드리지 않고, 변화를 일으킨 새로운 상태 객체를 만들어 반환한다.
- 똑같은 파라미터로 호출 된 리듀서 함수는 **언제나** 똑같은 결과값을 반환해야 한다. 

